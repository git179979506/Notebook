###Collection Views

集合视图使用标准或自定义布局显示数据项的有序集合。与表视图类似，集合视图从您的自定义数据源对象获取数据，并使用单元格，布局和补充视图的组合显示它。集合视图可以在网格中或您设计的自定义布局中显示项目。无论您选择的布局样式如何，集合视图最适合显示非分层的有序数据项。

**Purpose.**集合视图允许用户：
- 查看可变大小项目的目录，可选择分为多个章节
- 添加到、重新排列和编辑项目集合
- 从频繁更改的项目显示中选择

**Configuration.**在Interface Builder中的Attributes Inspector的“集合视图”部分中配置集合视图。有些配置不能通过Attributes Inspector进行，因此必须以编程方式进行。 如果您愿意，也可以以编程方式设置其他配置。

![](/assets/Snip20161104_12.png)    

![](/assets/Snip20161104_13.png)

####集合视图的内容

单元格是您的集合视图的主要内容。单元格的工作是为您的数据源对象显示单个项目的内容。每个单元格必须是UICollectionViewCell类的实例，您可以根据需要呈现您的内容。单元对象为管理自己的选择和高亮状态提供了固有的支持，虽然一些自定义代码必须被写入以实际应用高亮到单元格。UICollectionViewCell对象是您用于主要数据项的特定类型的可重用视图。

为了管理数据的可视化呈现，集合视图使用许多相关类，例如UICollectionViewController，UICollectionViewDataSource，UICollectionViewDelegate，UICollectionReusableView，UICollectionViewCell，UICollectionViewLayout和UICollectionViewLayoutAttributes。

集合视图强制在呈现的数据和用于呈现的视觉元素之间的严格分离。 您的应用程序是通过自定义数据源对象管理数据负责。 （要了解如何创建这些对象，请参阅Designing Your Data Objects。）您的应用程序还提供用于呈现数据的视图对象。 集合视图接受您的视图，并且在布局对象的帮助下，指定放置和其他视觉属性 — 完成在屏幕上显示它们的所有工作。

![](/assets/Snip20161103_9.png)
要以有效的方式在屏幕上显示内容，集合视图使用以下可重用的视图对象：

- **cell:** 表示一个数据项。
- **Supplementary view:** 表示与数据项相关的信息，例如节标题或页脚。
- **Decoration view:** 表示不属于您数据的纯装饰内容，例如背景图片。

![](/assets/Snip20161104_11.png)

因为集合视图使用这些和其他对象来确定数据的可视化表示，所以在Interface Builder中配置集合视图意味着您需要单独配置一些对象。

- **Items:** 您为其定义不同单元格对象的不同类型数据的数量。 如果您的应用只使用一种类型的数据项（无论您显示的数据项的总数），请将此值设置为1。
- **Accessories:** 每个部分的页眉或页脚视图的存在（此属性不适用于自定义布局）。根据需要选择节标题或节标题。

在Collection Reusable View属性检查器（控制补充视图，装饰视图和单元格）中，您可以设置标识符（标识符）字段。输入您在代码中使用的ID，以标识可重用单元格，装饰或辅助视图对象。

  ![](/assets/Snip20161104_14.png)

####集合视图的行为

您可以在集合视图中支持几种行为。 例如，您可能希望允许用户：
- 选择一个或多个项目
- 插入，删除和重新排列项目或部分
- 编辑项目

默认情况下，当集合视图检测到用户点击特定单元格时，它会根据需要更新单元格的`selected`或`highlighted`的属性。 您可以编写配置集合视图的代码以支持多项目选择，或者自己绘制`selected`或`highlighted`的状态。要了解如何支持多个选择或自定义选择状态，请参阅Managing the Visual State for Selections and Highlights。

要支持在集合视图中插入，删除或重新排序单元格，请更改数据源，然后指示集合视图重新显示内容。默认情况下，集合视图动画化单个项目的插入，删除或移动; 如果要同时对多个项目的这些更改进行动画处理，请使用代码块批量更新。要了解如何对集合视图的多个更改进行动画处理，请参阅Inserting, Deleting, and Moving Sections and Items。要让用户通过拖动移动项目或项目，您还需要结合自定义手势识别器。（要了解如何执行此操作，请参阅Manipulating Cells and Views。）

在故事板中配置单元格和补充视图时，可以通过将项目拖动到集合视图并在其中进行配置来实现。这将在集合视图和相应的单元格或视图之间创建关系。对于单元格，从对象库中拖动集合视图单元格并将其放置到集合视图中。将自定义类和您的单元格的集合可重用视图标识符设置为适当的值。

无论用户选择还是取消选择单元格，单元格的选中状态(selected state)总是最后要更改的。点击单元格总是首先改变单元的高亮状态(highlighted state)。 只有在点击序列结束并且在该序列期间应用的任何突出部分被移除之后，单元的选定状态才改变。在设计单元格时，应确保突出高亮和选定状态的视觉外观不会以无意的方式发生冲突。

当用户在单元格上执行`long-tap`手势时，集合视图尝试显示该单元格的编辑菜单。“编辑”菜单可用于剪切，复制和粘贴集合视图中的单元格。

如果使用UICollectionViewFlowLayout类，则可以使用属性检查器将“Scroll Direction”字段设置为“水平”或“垂直”。 请注意，此属性不适用于自定义布局。



